<!DOCTYPE html>
<html lang="en">
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WZHW34FRXN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WZHW34FRXN');
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ishan's Website</title>

<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

<style>
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family:'JetBrains Mono', monospace;
    background:#000;
    color:#00ff00;
    overflow:hidden;
    line-height:1.6;
    height:100vh;
}

#globe-canvas {
    position:fixed; 
    top:0; 
    left:0; 
    width:100%; 
    height:100%; 
    z-index:1;
}

.crt-effect {
    position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999;
    background:linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,.25) 50%);
    background-size:100% 4px;
    animation:crt-flicker .15s infinite;
}
@keyframes crt-flicker { 0%,100%{opacity:.97} 50%{opacity:1} }

/* ================= HEADER ================= */
.header {
    position:fixed;
    top:2rem;
    left:2rem;
    z-index:10;
    text-align:left;
}

.main-title {
    font-size:2.5rem;
    font-weight:700;
    color:#00ff00;
    text-shadow:0 0 20px #00ff00, 0 0 40px #00ff00;
    margin-bottom:0.3rem;
    letter-spacing:2px;
}

.subtitle {
    color:#00ff00;
    font-size:1.2rem;
    font-weight:400;
    text-shadow:0 0 10px #00ff00;
    letter-spacing:4px;
    opacity:0.8;
}

.location-time {
    color:#00ff00;
    font-size:0.75rem;
    font-weight:400;
    text-shadow:0 0 5px #00ff00;
    opacity:0.7;
    margin-top:0.5rem;
    letter-spacing:1px;
}

/* ================= SOCIAL LINKS SIDEBAR ================= */
.social-sidebar {
    position:fixed;
    right:2rem;
    top:50%;
    transform:translateY(-50%);
    z-index:10;
    display:flex;
    flex-direction:column;
    gap:2rem;
}

.social-link {
    color:#00ff00;
    text-decoration:none;
    font-size:0.85rem;
    padding:0.8rem;
    border:1px solid #00ff00;
    border-radius:50%;
    width:50px;
    height:50px;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:all 0.3s;
    text-shadow:0 0 5px #00ff00;
    background:rgba(0,0,0,0.5);
    position:relative;
}

.social-link:hover {
    background:rgba(0,255,0,0.1);
    box-shadow:0 0 20px #00ff00;
    transform:scale(1.1);
}

.social-link::before {
    content:attr(data-label);
    position:absolute;
    right:60px;
    background:rgba(0,0,0,0.9);
    padding:0.5rem 1rem;
    border:1px solid #00ff00;
    border-radius:4px;
    white-space:nowrap;
    opacity:0;
    pointer-events:none;
    transition:all 0.3s;
}

.social-link:hover::before {
    opacity:1;
    right:65px;
}

/* ================= CORNER ACCENTS ================= */
/* .corner {
    position:fixed;
    width:30px;
    height:30px;
    border:2px solid #00ff00;
    z-index:10;
    box-shadow:0 0 10px #00ff00;
}
.corner.top-left { top:0; left:0; border-right:none; border-bottom:none; }
.corner.top-right { top:0; right:0; border-left:none; border-bottom:none; }
.corner.bottom-left { bottom:0; left:0; border-right:none; border-top:none; }
.corner.bottom-right { bottom:0; right:0; border-left:none; border-top:none; } */

/* ================= SYSTEM STATUS PANEL ================= */
.system-status {
    position:fixed;
    bottom:2rem;
    right:2rem;
    z-index:10;
    background:rgba(0,0,0,0.9);
    border:1px solid #00ff00;
    border-radius:5px;
    padding:1rem;
    box-shadow:0 0 20px #00ff00;
    min-width:200px;
}

.system-status-title {
    color:#00ff00;
    font-size:0.75rem;
    text-align:center;
    margin-bottom:0.8rem;
    text-shadow:0 0 5px #00ff00;
    font-weight:700;
    letter-spacing:2px;
    border-bottom:1px solid rgba(0,255,0,0.3);
    padding-bottom:0.5rem;
}

.status-item {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:0.6rem;
    font-size:0.7rem;
}

.status-label {
    color:#00ff00;
    opacity:0.7;
    letter-spacing:1px;
}

.status-value {
    color:#00ff00;
    font-weight:700;
    text-shadow:0 0 5px #00ff00;
    letter-spacing:0.5px;
}

.status-online {
    display:inline-block;
    width:8px;
    height:8px;
    background:#00ff00;
    border-radius:50%;
    margin-left:5px;
    box-shadow:0 0 10px #00ff00;
    animation:pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% { opacity:1; }
    50% { opacity:0.5; }
}

/* ================= SUBMENU ================= */
.submenu {
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
    z-index:100;
    display:none;
    background:rgba(0,0,0,0.95);
    border:2px solid #00ff00;
    border-radius:10px;
    padding:2rem;
    box-shadow:0 0 50px #00ff00;
    min-width:400px;
    max-width:90vw;
    max-height:80vh;
    overflow-y:auto;
}

.submenu.active {
    display:block;
    animation:slideIn 0.3s ease;
}

@keyframes slideIn {
    from { transform:translate(-50%, -50%) scale(0.8); opacity:0; }
    to { transform:translate(-50%, -50%) scale(1); opacity:1; }
}

.submenu-title {
    font-size:2rem;
    color:#00ff00;
    text-align:center;
    margin-bottom:2rem;
    text-shadow:0 0 10px #00ff00;
}

.submenu-items {
    display:flex;
    flex-direction:column;
    gap:1rem;
}

.submenu-item {
    color:#00ff00;
    text-decoration:none;
    padding:1rem 2rem;
    border:1px solid #00ff00;
    border-radius:5px;
    text-align:center;
    transition:all 0.3s;
    font-size:1.1rem;
    background:rgba(0,0,0,0.5);
}

.submenu-item:hover {
    background:rgba(0,255,0,0.2);
    box-shadow:0 0 20px #00ff00;
    transform:scale(1.05);
}

.close-submenu {
    position:absolute;
    top:1rem;
    right:1rem;
    color:#00ff00;
    font-size:1.5rem;
    cursor:pointer;
    border:none;
    background:none;
    transition:all 0.3s;
}

.close-submenu:hover {
    text-shadow:0 0 10px #00ff00;
    transform:scale(1.2);
}

/* ================= RESPONSIVE STYLES ================= */
@media (max-width: 768px) {
    .header {
        top:1rem;
        left:1rem;
        right:1rem;
    }
    
    .main-title {
        font-size:1.5rem;
        letter-spacing:1px;
    }
    
    .subtitle {
        font-size:0.8rem;
        letter-spacing:2px;
    }
    
    .location-time {
        font-size:0.65rem;
        margin-top:0.3rem;
    }
    
    .social-sidebar {
        right:1rem;
        gap:1rem;
    }
    
    .social-link {
        width:40px;
        height:40px;
        padding:0.6rem;
    }
    
    .social-link svg {
        width:20px;
        height:20px;
    }
    
    .social-link::before {
        display:none;
    }
    
    .corner {
        width:20px;
        height:20px;
    }
    
    .system-status {
        bottom:1rem;
        right:1rem;
        padding:0.8rem;
        min-width:180px;
    }
    
    .system-status-title {
        font-size:0.65rem;
        margin-bottom:0.6rem;
    }
    
    .status-item {
        font-size:0.65rem;
        margin-bottom:0.5rem;
    }
    
    .submenu {
        min-width:auto;
        width:90vw;
        padding:1.5rem;
    }
    
    .submenu-title {
        font-size:1.5rem;
        margin-bottom:1.5rem;
    }
    
    .submenu-item {
        padding:0.8rem 1.5rem;
        font-size:0.95rem;
    }
    
    .close-submenu {
        font-size:1.2rem;
    }
}

@media (max-width: 480px) {
    .header {
        top:0.5rem;
        left:0.5rem;
        right:0.5rem;
    }
    
    .main-title {
        font-size:1.2rem;
        letter-spacing:0.5px;
    }
    
    .subtitle {
        font-size:0.7rem;
        letter-spacing:1px;
    }
    
    .location-time {
        font-size:0.55rem;
        margin-top:0.2rem;
    }
    
    .social-sidebar {
        right:0.5rem;
        gap:0.8rem;
    }
    
    .social-link {
        width:35px;
        height:35px;
        padding:0.5rem;
    }
    
    .social-link svg {
        width:18px;
        height:18px;
    }
    
    .corner {
        width:15px;
        height:15px;
        border-width:1px;
    }
    
    .system-status {
        bottom:0.5rem;
        right:0.5rem;
        padding:0.6rem;
        min-width:160px;
    }
    
    .system-status-title {
        font-size:0.6rem;
        margin-bottom:0.5rem;
    }
    
    .status-item {
        font-size:0.6rem;
        margin-bottom:0.4rem;
    }
    
    .status-online {
        width:6px;
        height:6px;
    }
    
    .submenu {
        padding:1rem;
    }
    
    .submenu-title {
        font-size:1.2rem;
        margin-bottom:1rem;
    }
    
    .submenu-item {
        padding:0.6rem 1rem;
        font-size:0.85rem;
    }
}
</style>
</head>
<body>

<canvas id="globe-canvas"></canvas>
<div class="crt-effect"></div>

<!-- <div class="corner top-left"></div>
<div class="corner top-right"></div>
<div class="corner bottom-left"></div>
<div class="corner bottom-right"></div> -->
<div style="position:fixed; bottom:0.5rem; left:2rem; z-index:10; color:#00ff00; font-size:0.7rem; opacity:0.7; letter-spacing:1px;">© 2026 Ishan Kumar Anand All Rights Reserved.</div>

<div class="header">
    <div class="main-title">ISHAN KUMAR ANAND</div>
    <div class="subtitle">AI ENGINEER</div>
    <div class="location-time">
        <span>San Diego</span> | <span id="live-time">00:00:00</span>
    </div>
</div>

<div class="social-sidebar">
    <a href="https://github.com/Ishushan02" target="_blank" class="social-link" data-label="GitHub">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
        </svg>
    </a>
    <a href="https://linkedin.com/in/ishushan" target="_blank" class="social-link" data-label="LinkedIn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
            <rect x="2" y="9" width="4" height="12"/>
            <circle cx="4" cy="4" r="2"/>
        </svg>
    </a>
    <a href="mailto:isanand@ucsd.edu" class="social-link" data-label="Email">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
            <polyline points="22,6 12,13 2,6"/>
        </svg>
    </a>
</div>

<div class="system-status">
    <div class="system-status-title">SYSTEM STATUS</div>
    <div class="status-item">
        <span class="status-label">STATUS</span>
        <span class="status-value">ONLINE<span class="status-online"></span></span>
    </div>
    <div class="status-item">
        <span class="status-label">GITHUB [30d]</span>
        <span class="status-value" id="github-commits">Loading...</span>
    </div>
</div>

<div id="submenu" class="submenu">
    <button class="close-submenu" onclick="closeSubmenu()">✕</button>
    <div class="submenu-title" id="submenu-title"></div>
    <div class="submenu-items" id="submenu-items"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
// Live time update
function updateTime() {
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    document.getElementById('live-time').textContent = `${hours}:${minutes}:${seconds}`;
}

updateTime();
setInterval(updateTime, 1000);

// GitHub commits from stats.json (updated by GitHub Actions)
async function fetchGitHubCommits() {
    try {
        // Fetch stats from your own repo's stats.json file
        // This file is updated daily by GitHub Actions
        const response = await fetch('stats.json');
        
        if (response.ok) {
            const data = await response.json();
            document.getElementById('github-commits').textContent = `${data.commits} commits`;
        } else {
            // Fallback if stats.json doesn't exist yet
            document.getElementById('github-commits').textContent = '36 repos';
        }
    } catch (error) {
        console.error('Error fetching GitHub stats:', error);
        document.getElementById('github-commits').textContent = '36 repos';
    }
}

fetchGitHubCommits();
// Refresh every 5 minutes to get latest stats
setInterval(fetchGitHubCommits, 300000);

const canvas = document.getElementById('globe-canvas');
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });

renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
camera.position.z = 5;

// Reset camera position on page load/back button
window.addEventListener('pageshow', function(event) {
    camera.position.set(0, 0, 5);
    camera.lookAt(0, 0, 0);
    rotationPaused = false;
    if (hoveredObject) {
        hoveredObject.scale.set(1, 1, 1);
        hoveredObject = null;
    }
});

// Create main globe
const geometry = new THREE.SphereGeometry(2, 64, 64);
const material = new THREE.MeshBasicMaterial({
    color: 0x00ff00,
    wireframe: true,
    transparent: true,
    opacity: 0.3
});

const globe = new THREE.Mesh(geometry, material);
scene.add(globe);

// Add background stars with velocities
const starGeometry = new THREE.BufferGeometry();
const starVertices = [];
const starVelocities = [];
const starCount = 2000;

for (let i = 0; i < starCount; i++) {
    const x = (Math.random() - 0.5) * 100;
    const y = (Math.random() - 0.5) * 100;
    const z = (Math.random() - 0.5) * 100;
    starVertices.push(x, y, z);
    
    // Add velocity for movement
    starVelocities.push(
        (Math.random() - 0.5) * 0.01,
        (Math.random() - 0.5) * 0.01,
        (Math.random() - 0.5) * 0.01
    );
}

starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
const starMaterial = new THREE.PointsMaterial({ 
    color: 0x00ff00, 
    size: 0.1,
    transparent: true,
    opacity: 0.8
});
const stars = new THREE.Points(starGeometry, starMaterial);
scene.add(stars);

// Add glowing dots on globe
const dotGeometry = new THREE.SphereGeometry(0.02, 8, 8);
const dotMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const dotCount = 300;

for (let i = 0; i < dotCount; i++) {
    const dot = new THREE.Mesh(dotGeometry, dotMaterial);
    const theta = Math.random() * Math.PI * 2;
    const phi = Math.acos(2 * Math.random() - 1);
    const radius = 2;
    
    dot.position.x = radius * Math.sin(phi) * Math.cos(theta);
    dot.position.y = radius * Math.sin(phi) * Math.sin(theta);
    dot.position.z = radius * Math.cos(phi);
    
    globe.add(dot);
}

// Menu data
const menuData = {
    experience: {
        title: "EXPERIENCE",
        icon: "E",
        url: "experience/"
    },
    projects: {
        title: "PROJECTS",
        icon: "P",
        url: "projects/"
    },
    education: {
        title: "EDUCATION",
        icon: "Ed",
        url: "education/"
    },
    publication: {
        title: "PUBLICATION",
        icon: "Pb",
        url: "publication/"
    }
};

// Create orbiting symbols
const orbitingObjects = [];
const orbitRadius = 3.5;
const orbitSpeed = 0.3;
let rotationPaused = false;
let hoveredObject = null;

Object.keys(menuData).forEach((key, index) => {
    const data = menuData[key];
    
    const group = new THREE.Group();
    
    // Create small wireframe globe (same style as main globe)
    const smallGlobeGeometry = new THREE.SphereGeometry(0.5, 32, 32);
    const smallGlobeMaterial = new THREE.MeshBasicMaterial({
        color: 0x00ff00,
        wireframe: true,
        transparent: true,
        opacity: 0.35
    });
    const smallGlobe = new THREE.Mesh(smallGlobeGeometry, smallGlobeMaterial);
    group.add(smallGlobe);
    
    // Add dots on small globe
    const smallDotGeometry = new THREE.SphereGeometry(0.01, 8, 8);
    const smallDotMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
    const smallDotCount = 50;
    
    for (let i = 0; i < smallDotCount; i++) {
        const dot = new THREE.Mesh(smallDotGeometry, smallDotMaterial);
        const theta = Math.random() * Math.PI * 2;
        const phi = Math.acos(2 * Math.random() - 1);
        const radius = 0.5;
        
        dot.position.x = radius * Math.sin(phi) * Math.cos(theta);
        dot.position.y = radius * Math.sin(phi) * Math.sin(theta);
        dot.position.z = radius * Math.cos(phi);
        
        smallGlobe.add(dot);
    }
    
    // Create text sprite at center
    const canvas = document.createElement('canvas');
    const context = canvas.getContext('2d');
    canvas.width = 512;
    canvas.height = 512;
    
    context.fillStyle = '#00ff00';
    // context.font = 'bold 60px JetBrains Mono';
    context.font = 'bold 60px Times New Roman';
    context.textAlign = 'center';
    context.textBaseline = 'middle';
    
    // Split text into lines if needed
    const words = data.title.split(' ');
    const lineHeight = 70;
    const startY = 256 - ((words.length - 1) * lineHeight / 2);
    
    words.forEach((word, i) => {
        context.fillText(word, 256, startY + (i * lineHeight));
    });
    
    const texture = new THREE.CanvasTexture(canvas);
    const spriteMaterial = new THREE.SpriteMaterial({ 
        map: texture,
        transparent: true
    });
    const sprite = new THREE.Sprite(spriteMaterial);
    sprite.scale.set(1, 1, 1);
    
    group.add(sprite);
    
    group.userData = {
        key: key,
        angle: (index / Object.keys(menuData).length) * Math.PI * 2,
        data: data,
        smallGlobe: smallGlobe
    };
    
    scene.add(group);
    orbitingObjects.push(group);
});

// Raycaster for mouse interaction
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();

// Handle both mouse and touch events
function updateMousePosition(clientX, clientY) {
    mouse.x = (clientX / window.innerWidth) * 2 - 1;
    mouse.y = -(clientY / window.innerHeight) * 2 + 1;
    
    raycaster.setFromCamera(mouse, camera);
    const intersects = raycaster.intersectObjects(orbitingObjects, true);
    
    if (intersects.length > 0) {
        const object = intersects[0].object.parent;
        if (object.userData.key) {
            hoveredObject = object;
            rotationPaused = true;
            canvas.style.cursor = 'pointer';
            
            // Scale up hovered object
            object.scale.set(1.3, 1.3, 1.3);
        }
    } else {
        if (hoveredObject) {
            hoveredObject.scale.set(1, 1, 1);
        }
        hoveredObject = null;
        rotationPaused = false;
        canvas.style.cursor = 'default';
    }
}

canvas.addEventListener('mousemove', (event) => {
    updateMousePosition(event.clientX, event.clientY);
});

let touchStartX = 0;
let touchStartY = 0;

canvas.addEventListener('touchstart', (event) => {
    if (event.touches.length > 0) {
        touchStartX = event.touches[0].clientX;
        touchStartY = event.touches[0].clientY;
        updateMousePosition(touchStartX, touchStartY);
    }
}, { passive: true });

canvas.addEventListener('touchmove', (event) => {
    if (event.touches.length > 0) {
        updateMousePosition(event.touches[0].clientX, event.touches[0].clientY);
    }
}, { passive: true });

function handleInteraction(clientX, clientY) {
    mouse.x = (clientX / window.innerWidth) * 2 - 1;
    mouse.y = -(clientY / window.innerHeight) * 2 + 1;
    
    raycaster.setFromCamera(mouse, camera);
    const intersects = raycaster.intersectObjects(orbitingObjects, true);
    
    if (intersects.length > 0) {
        const object = intersects[0].object.parent;
        if (object.userData.key && object.userData.data) {
            // Zoom into globe effect
            const targetPos = object.position.clone();
            const startPos = camera.position.clone();
            const startTime = Date.now();
            const duration = 1000;
            
            rotationPaused = true;
            
            function zoomIn() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 3);
                
                camera.position.lerpVectors(startPos, targetPos, easeProgress);
                camera.lookAt(targetPos);
                
                if (progress < 1) {
                    requestAnimationFrame(zoomIn);
                } else {
                    window.location.href = object.userData.data.url;
                }
            }
            
            zoomIn();
        }
    }
}

canvas.addEventListener('click', (event) => {
    handleInteraction(event.clientX, event.clientY);
});

canvas.addEventListener('touchend', (event) => {
    if (event.changedTouches.length > 0) {
        const touch = event.changedTouches[0];
        const touchEndX = touch.clientX;
        const touchEndY = touch.clientY;
        
        // Check if it's a tap (not a swipe)
        const deltaX = Math.abs(touchEndX - touchStartX);
        const deltaY = Math.abs(touchEndY - touchStartY);
        
        if (deltaX < 10 && deltaY < 10) {
            handleInteraction(touchEndX, touchEndY);
        }
    }
}, { passive: true });

function showSubmenu(data) {
    const submenu = document.getElementById('submenu');
    const title = document.getElementById('submenu-title');
    const items = document.getElementById('submenu-items');
    
    title.textContent = data.title;
    items.innerHTML = '';
    
    data.items.forEach(item => {
        const link = document.createElement('a');
        link.href = item.url;
        link.className = 'submenu-item';
        link.textContent = item.name;
        items.appendChild(link);
    });
    
    submenu.classList.add('active');
}

function closeSubmenu() {
    document.getElementById('submenu').classList.remove('active');
}

// Animation
let time = 0;
function animate() {
    requestAnimationFrame(animate);
    time += 0.01;
    
    // Animate stars
    const positions = stars.geometry.attributes.position.array;
    for (let i = 0; i < positions.length; i += 3) {
        positions[i] += starVelocities[i] * 0.3;
        positions[i + 1] += starVelocities[i + 1] * 0.3;
        positions[i + 2] += starVelocities[i + 2] * 0.3;
        
        // Wrap around
        if (Math.abs(positions[i]) > 50) positions[i] *= -1;
        if (Math.abs(positions[i + 1]) > 50) positions[i + 1] *= -1;
        if (Math.abs(positions[i + 2]) > 50) positions[i + 2] *= -1;
    }
    stars.geometry.attributes.position.needsUpdate = true;
    
    // Rotate main globe
    globe.rotation.y += 0.002;
    globe.rotation.x = Math.sin(time * 0.3) * 0.1;
    
    // Orbit menu symbols around globe
    if (!rotationPaused) {
        orbitingObjects.forEach((obj) => {
            obj.userData.angle += orbitSpeed * 0.01;
            
            const x = Math.cos(obj.userData.angle) * orbitRadius;
            const z = Math.sin(obj.userData.angle) * orbitRadius;
            const y = Math.sin(obj.userData.angle * 2) * 0.5;
            
            obj.position.set(x, y, z);
            obj.lookAt(camera.position);
            
            // Rotate small globe
            if (obj.userData.smallGlobe) {
                obj.userData.smallGlobe.rotation.y += 0.01;
            }
        });
    } else if (hoveredObject && hoveredObject.userData.key) {
        // Keep hovered object visible and rotate its small globe
        hoveredObject.lookAt(camera.position);
        if (hoveredObject.userData.smallGlobe) {
            hoveredObject.userData.smallGlobe.rotation.y += 0.01;
        }
    }
    
    renderer.render(scene, camera);
}

animate();

// Handle window resize
window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});

// Close submenu on Escape key
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeSubmenu();
    }
});
</script>

</body>
</html>